<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Train &amp; evaluate on multiple train/test splits with different random seeds">

<title>mirzai - 3.2. Train &amp; evaluate (PLSR)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="mirzai - 3.2. Train &amp; evaluate (PLSR)">
<meta property="og:description" content="Train &amp; evaluate on multiple train/test splits with different random seeds">
<meta property="og:site-name" content="mirzai">
<meta name="twitter:title" content="mirzai - 3.2. Train &amp; evaluate (PLSR)">
<meta name="twitter:description" content="Train &amp; evaluate on multiple train/test splits with different random seeds">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">mirzai</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">3.2. Train &amp; evaluate (PLSR)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Paper with code</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/eda.html" class="sidebar-item-text sidebar-link">1. EDA (Exploratory Data Analysis)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/select_transform.html" class="sidebar-item-text sidebar-link">2. Select &amp; transform</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">3. Baseline model (PLSR)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/plsr_learning_curve.html" class="sidebar-item-text sidebar-link">3.1. Learning Curve (PLSR)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/plsr_train_eval.html" class="sidebar-item-text sidebar-link active">3.2. Train &amp; evaluate (PLSR)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">4. Convolutional Neural Network (CNN)</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/cnn_lr_finder.html" class="sidebar-item-text sidebar-link">4.1 CNN learning rate finder</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/cnn_learning_curve.html" class="sidebar-item-text sidebar-link">4.2. Learning curve (CNN)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/cnn_train_eval.html" class="sidebar-item-text sidebar-link">4.3. Train &amp; evaluate (CNN)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/cnn_valid_curve_by_tax.html" class="sidebar-item-text sidebar-link">4.4. Validation curve by Soil Taxonomy Orders (CNN)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">5. PLSR vs.&nbsp;CNN figures</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/figures_learning_curves.html" class="sidebar-item-text sidebar-link">5.1. PLSR vs.&nbsp;CNN Learning Curves</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/figures_observed_vs_predicted.html" class="sidebar-item-text sidebar-link">5.2. Observed vs.&nbsp;predicted scatterplots</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/figures_global_vs_local.html" class="sidebar-item-text sidebar-link">5.3. Global vs.&nbsp;local modelling</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">6. Interpretability</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/interpretation_gradshap.html" class="sidebar-item-text sidebar-link">6.1. GradientShap values</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../paper/interpretation_gradshap_corr.html" class="sidebar-item-text sidebar-link">6.2. GradientShap values correlation</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">API</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">data</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/data/loading.html" class="sidebar-item-text sidebar-link">Loading</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/data/selection.html" class="sidebar-item-text sidebar-link">Selection</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/data/transform.html" class="sidebar-item-text sidebar-link">Transform</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/data/torch.html" class="sidebar-item-text sidebar-link">PyTorch data loaders and transforms</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">vis</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/vis/core.html" class="sidebar-item-text sidebar-link">Visualization</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">training</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/training/core.html" class="sidebar-item-text sidebar-link">Core</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/training/metrics.html" class="sidebar-item-text sidebar-link">Metrics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/training/plsr.html" class="sidebar-item-text sidebar-link">Training &amp; validation (PLSR)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/training/cnn.html" class="sidebar-item-text sidebar-link">Training &amp; validation (CNN)</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-and-transform" id="toc-load-and-transform" class="nav-link active" data-scroll-target="#load-and-transform">Load and transform</a></li>
  <li><a href="#experiment" id="toc-experiment" class="nav-link" data-scroll-target="#experiment">Experiment</a>
  <ul class="collapse">
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#train-on-all-soil-taxonomic-orders" id="toc-train-on-all-soil-taxonomic-orders" class="nav-link" data-scroll-target="#train-on-all-soil-taxonomic-orders">Train on all Soil Taxonomic Orders</a></li>
  <li><a href="#train-and-test-on-mollisols" id="toc-train-and-test-on-mollisols" class="nav-link" data-scroll-target="#train-and-test-on-mollisols">Train and test on Mollisols</a></li>
  <li><a href="#train-and-test-on-gelisols" id="toc-train-and-test-on-gelisols" class="nav-link" data-scroll-target="#train-and-test-on-gelisols">Train and test on Gelisols</a></li>
  <li><a href="#train-and-test-on-vertisols" id="toc-train-and-test-on-vertisols" class="nav-link" data-scroll-target="#train-and-test-on-vertisols">Train and test on Vertisols</a></li>
  <li><a href="#compile-metrics-for-local-vs.-global-fig.-6" id="toc-compile-metrics-for-local-vs.-global-fig.-6" class="nav-link" data-scroll-target="#compile-metrics-for-local-vs.-global-fig.-6">Compile metrics for “local vs.&nbsp;global” Fig. 6</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/franckalbinet/mirzai/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">3.2. Train &amp; evaluate (PLSR)</h1>
</div>

<div>
  <div class="description">
    Train &amp; evaluate on multiple train/test splits with different random seeds
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://colab.research.google.com/github/franckalbinet/mirzai/blob/main/nbs/paper/04_plsr_train_eval.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'google.colab'</span> <span class="kw">in</span> <span class="bu">str</span>(get_ipython()):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    drive.mount(<span class="st">'/content/drive'</span>,  force_remount<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install mirzai</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python utilities</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># mirzai utilities</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mirzai.data.loading <span class="im">import</span> load_kssl</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mirzai.data.selection <span class="im">import</span> (select_y, select_tax_order, select_X)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mirzai.data.transform <span class="im">import</span> (log_transform_y, CO2_REGION)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#from mirzai.training.plsr import (compute_valid_curve, PLS_model, Evaluator)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mirzai.training.plsr <span class="im">import</span> (PLS_model, Learners)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.transform <span class="im">import</span> compose</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Data science stack</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-and-transform" class="level2">
<h2 class="anchored" data-anchor-id="load-and-transform">Load and transform</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>src_dir <span class="op">=</span> <span class="st">'data'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fnames <span class="op">=</span> [<span class="st">'spectra-features.npy'</span>, <span class="st">'spectra-wavenumbers.npy'</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">'depth-order.npy'</span>, <span class="st">'target.npy'</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">'tax-order-lu.pkl'</span>, <span class="st">'spectra-id.npy'</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>X, X_names, depth_order, y, tax_lookup, X_id <span class="op">=</span> load_kssl(src_dir, fnames<span class="op">=</span>fnames)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> X, y, X_id, depth_order</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>transforms <span class="op">=</span> [select_y, select_tax_order, select_X, log_transform_y]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>X, y, X_id, depth_order <span class="op">=</span> compose(<span class="op">*</span>transforms)(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'X shape: </span><span class="sc">{</span>X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'y shape: </span><span class="sc">{</span>y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Wavenumbers:</span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>X_names<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'depth_order (first 3 rows):</span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>depth_order[:<span class="dv">3</span>, :]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Taxonomic order lookup:</span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tax_lookup<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape: (40132, 1764)
y shape: (40132,)
Wavenumbers:
 [3999 3997 3995 ...  603  601  599]
depth_order (first 3 rows):
 [[43.  2.]
 [ 0.  0.]
 [ 0.  1.]]
Taxonomic order lookup:
 {'alfisols': 0, 'mollisols': 1, 'inceptisols': 2, 'entisols': 3, 'spodosols': 4, 'undefined': 5, 'ultisols': 6, 'andisols': 7, 'histosols': 8, 'oxisols': 9, 'vertisols': 10, 'aridisols': 11, 'gelisols': 12}</code></pre>
</div>
</div>
</section>
<section id="experiment" class="level2">
<h2 class="anchored" data-anchor-id="experiment">Experiment</h2>
<section id="setup" class="level3">
<h3 class="anchored" data-anchor-id="setup">Setup</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>split_ratio <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>dest_dir <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="train-on-all-soil-taxonomic-orders" class="level3">
<h3 class="anchored" data-anchor-id="train-on-all-soil-taxonomic-orders">Train on all Soil Taxonomic Orders</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dest_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/all/models'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>learners.train((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]), </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>               n_cpts_range<span class="op">=</span><span class="bu">range</span>(<span class="dv">40</span>, <span class="dv">70</span>, <span class="dv">2</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>               delta<span class="op">=</span><span class="fl">2e-3</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>               dest_dir_model<span class="op">=</span>dest_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------------------------------------
Seed: 0
--------------------------------------------------------------------------------
# of components chosen: 50
--------------------------------------------------------------------------------
Seed: 1
--------------------------------------------------------------------------------
# of components chosen: 52
--------------------------------------------------------------------------------
Seed: 2
--------------------------------------------------------------------------------
# of components chosen: 54
--------------------------------------------------------------------------------
Seed: 3
--------------------------------------------------------------------------------
# of components chosen: 56
--------------------------------------------------------------------------------
Seed: 4
--------------------------------------------------------------------------------
# of components chosen: 52
--------------------------------------------------------------------------------
Seed: 5
--------------------------------------------------------------------------------
# of components chosen: 54
--------------------------------------------------------------------------------
Seed: 6
--------------------------------------------------------------------------------
# of components chosen: 58
--------------------------------------------------------------------------------
Seed: 7
--------------------------------------------------------------------------------
# of components chosen: 62
--------------------------------------------------------------------------------
Seed: 8
--------------------------------------------------------------------------------
# of components chosen: 48
--------------------------------------------------------------------------------
Seed: 9
--------------------------------------------------------------------------------
# of components chosen: 52
--------------------------------------------------------------------------------
Seed: 10
--------------------------------------------------------------------------------
# of components chosen: 58
--------------------------------------------------------------------------------
Seed: 11
--------------------------------------------------------------------------------
# of components chosen: 48
--------------------------------------------------------------------------------
Seed: 12
--------------------------------------------------------------------------------
# of components chosen: 48
--------------------------------------------------------------------------------
Seed: 13
--------------------------------------------------------------------------------
# of components chosen: 48
--------------------------------------------------------------------------------
Seed: 14
--------------------------------------------------------------------------------
# of components chosen: 44
--------------------------------------------------------------------------------
Seed: 15
--------------------------------------------------------------------------------
# of components chosen: 68
--------------------------------------------------------------------------------
Seed: 16
--------------------------------------------------------------------------------
# of components chosen: 44
--------------------------------------------------------------------------------
Seed: 17
--------------------------------------------------------------------------------
# of components chosen: 50
--------------------------------------------------------------------------------
Seed: 18
--------------------------------------------------------------------------------
# of components chosen: 64
--------------------------------------------------------------------------------
Seed: 19
--------------------------------------------------------------------------------
# of components chosen: 58</code></pre>
</div>
</div>
<section id="evaluate-on-all" class="level4">
<h4 class="anchored" data-anchor-id="evaluate-on-all">Evaluate on all</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/all/models'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>perfs_global_all, y_hats_all, y_trues_all <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                                                              src_dir_model<span class="op">=</span>src_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save spectific seed y_hat, y_true to plot "Observed vs. predicted" scatterplots</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dest_dir_predicted <span class="op">=</span> Path(<span class="st">'files/dumps/'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(dest_dir_predicted<span class="op">/</span><span class="ss">f'predicted-true-plsr-seed-</span><span class="sc">{</span>seed<span class="sc">}</span><span class="ss">.pickle'</span>, <span class="st">'wb'</span>) <span class="im">as</span> f: </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    pickle.dump((y_hats_all[seed].to_numpy(), y_trues_all[seed].to_numpy()), f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>perfs_global_all.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rpd</th>
      <th>rpiq</th>
      <th>r2</th>
      <th>lccc</th>
      <th>rmse</th>
      <th>mse</th>
      <th>mae</th>
      <th>mape</th>
      <th>bias</th>
      <th>stb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.658763</td>
      <td>2.272073</td>
      <td>0.636279</td>
      <td>0.780492</td>
      <td>1.057159</td>
      <td>1.306802</td>
      <td>0.335821</td>
      <td>135.026036</td>
      <td>-0.000259</td>
      <td>-0.000547</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.022627</td>
      <td>0.033917</td>
      <td>0.009834</td>
      <td>0.005444</td>
      <td>0.446290</td>
      <td>1.222881</td>
      <td>0.016914</td>
      <td>3.283663</td>
      <td>0.003848</td>
      <td>0.007405</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.623276</td>
      <td>2.204548</td>
      <td>0.620402</td>
      <td>0.771287</td>
      <td>0.671250</td>
      <td>0.450576</td>
      <td>0.308898</td>
      <td>130.007174</td>
      <td>-0.006300</td>
      <td>-0.012485</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.640177</td>
      <td>2.256584</td>
      <td>0.628185</td>
      <td>0.777881</td>
      <td>0.756833</td>
      <td>0.572822</td>
      <td>0.325999</td>
      <td>132.585609</td>
      <td>-0.003009</td>
      <td>-0.005756</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.660981</td>
      <td>2.267233</td>
      <td>0.637440</td>
      <td>0.780165</td>
      <td>0.861632</td>
      <td>0.742537</td>
      <td>0.331193</td>
      <td>134.434034</td>
      <td>-0.001383</td>
      <td>-0.002745</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.666828</td>
      <td>2.296689</td>
      <td>0.639975</td>
      <td>0.784414</td>
      <td>1.093822</td>
      <td>1.216215</td>
      <td>0.344576</td>
      <td>136.850054</td>
      <td>0.002217</td>
      <td>0.004202</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.707217</td>
      <td>2.328779</td>
      <td>0.656813</td>
      <td>0.793939</td>
      <td>2.242110</td>
      <td>5.027059</td>
      <td>0.372859</td>
      <td>140.504871</td>
      <td>0.007079</td>
      <td>0.013396</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/all/models'</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, v <span class="kw">in</span> {k: v <span class="cf">for</span> k, v <span class="kw">in</span> tax_lookup.items() <span class="cf">if</span> k <span class="op">!=</span> <span class="st">'oxisols'</span>}.items():</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">80</span><span class="op">*</span><span class="st">'-'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Test metrics on </span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">80</span><span class="op">*</span><span class="st">'-'</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    perfs_global, _, _ <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                                           order<span class="op">=</span>v,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                                           src_dir_model<span class="op">=</span>src_dir_model)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(perfs_global.describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------------------------------------
Test metrics on alfisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.488581   2.023110   0.544065   0.727878   0.411130   0.198526   
std     0.077245   0.111888   0.048141   0.028838   0.176213   0.187989   
min     1.335787   1.825327   0.438167   0.673686   0.207121   0.042899   
25%     1.429706   1.971203   0.509535   0.713507   0.282230   0.079724   
50%     1.493973   2.024866   0.550797   0.731100   0.390250   0.152373   
75%     1.533459   2.092083   0.573742   0.749183   0.462969   0.214501   
max     1.625880   2.267384   0.620742   0.769198   0.845685   0.715184   

             mae       mape       bias        stb  
count  20.000000  20.000000  20.000000  20.000000  
mean    0.162636  82.627329  -0.001926  -0.004745  
std     0.020796   4.371945   0.008761   0.023061  
min     0.128730  73.976273  -0.018855  -0.047651  
25%     0.146705  79.772143  -0.009633  -0.025287  
50%     0.159680  83.069107  -0.000834  -0.002193  
75%     0.179517  85.662533   0.003653   0.009967  
max     0.195241  93.340300   0.011908   0.032238  
--------------------------------------------------------------------------------
Test metrics on mollisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.582966   2.090417   0.599952   0.742203   0.769248   0.629664   
std     0.034982   0.078073   0.017652   0.012356   0.199794   0.322337   
min     1.525933   1.972214   0.570089   0.722419   0.526864   0.277585   
25%     1.558545   2.042070   0.587883   0.734876   0.600345   0.360454   
50%     1.579016   2.077462   0.598502   0.738004   0.735055   0.541195   
75%     1.610838   2.141203   0.614204   0.752421   0.917944   0.842758   
max     1.642984   2.250635   0.629145   0.764131   1.123730   1.262768   

             mae       mape       bias        stb  
count  20.000000  20.000000  20.000000  20.000000  
mean    0.307466  94.298259   0.001662   0.003734  
std     0.018656   3.052491   0.008008   0.018876  
min     0.279430  87.394573  -0.013899  -0.033922  
25%     0.289349  92.537801  -0.004175  -0.009866  
50%     0.308846  94.409650   0.001370   0.003153  
75%     0.320209  96.313669   0.008152   0.018857  
max     0.340558  98.688058   0.014374   0.032833  
--------------------------------------------------------------------------------
Test metrics on inceptisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.484931   2.062821   0.543190   0.715217   0.560004   0.327634   
std     0.052383   0.113698   0.032576   0.021247   0.121523   0.141674   
min     1.393604   1.834631   0.483181   0.680782   0.383973   0.147435   
25%     1.443211   1.980935   0.518045   0.696649   0.462424   0.214457   
50%     1.496851   2.072912   0.552023   0.716683   0.563604   0.317676   
75%     1.515227   2.150964   0.562994   0.733597   0.621687   0.386500   
max     1.588288   2.274688   0.602151   0.752080   0.802342   0.643753   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.258099  117.611669  -0.025303  -0.051641  
std     0.030971    6.840199   0.011152   0.023835  
min     0.206618  105.015942  -0.046778  -0.093141  
25%     0.236181  114.370854  -0.033645  -0.068934  
50%     0.253719  116.712206  -0.022784  -0.045203  
75%     0.276829  119.444905  -0.017516  -0.032937  
max     0.332711  134.933979  -0.007504  -0.014204  
--------------------------------------------------------------------------------
Test metrics on entisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.495344   2.102047   0.535041   0.733857   0.442698   0.204343   
std     0.160012   0.348114   0.099822   0.051184   0.093817   0.089328   
min     1.229760   1.616803   0.334548   0.616401   0.310090   0.096156   
25%     1.435865   1.802874   0.511824   0.723841   0.396742   0.157491   
50%     1.505428   2.070569   0.555707   0.748509   0.417861   0.174608   
75%     1.587539   2.257373   0.600692   0.761758   0.506173   0.256319   
max     1.916463   2.839117   0.725927   0.830845   0.663214   0.439853   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.227277  124.306496  -0.013363  -0.027085  
std     0.033105   15.203068   0.022993   0.048705  
min     0.172270  102.336085  -0.045416  -0.111028  
25%     0.209802  113.533998  -0.030312  -0.054147  
50%     0.226905  119.691934  -0.020139  -0.041128  
75%     0.247482  131.740359  -0.003590  -0.006261  
max     0.287580  161.354752   0.034848   0.076445  
--------------------------------------------------------------------------------
Test metrics on spodosols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.884385   2.713797   0.699472   0.824446   0.482583   0.249341   
std     0.238908   0.639696   0.079492   0.043133   0.131607   0.130359   
min     1.390288   1.803467   0.474431   0.721559   0.276331   0.076359   
25%     1.712985   2.360031   0.652982   0.792727   0.385248   0.148728   
50%     1.870642   2.527430   0.709356   0.835642   0.477664   0.228171   
75%     2.015491   3.008323   0.749113   0.844006   0.557888   0.312005   
max     2.398842   4.506760   0.823003   0.895621   0.706393   0.498991   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.262912  157.167552   0.014543   0.020080  
std     0.058003   19.733897   0.028305   0.043673  
min     0.171519  126.395882  -0.019549  -0.047892  
25%     0.219475  142.879484  -0.001157  -0.002089  
50%     0.263831  156.169654   0.007113   0.011952  
75%     0.296229  171.764491   0.019708   0.037011  
max     0.359890  188.821685   0.101276   0.143619  
--------------------------------------------------------------------------------
Test metrics on undefined
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.699452   2.327902   0.653167   0.788484   1.152385   1.582740   
std     0.032766   0.070709   0.013227   0.007203   0.517839   1.675655   
min     1.648992   2.217120   0.632006   0.777364   0.766317   0.587241   
25%     1.677440   2.275579   0.644376   0.781214   0.880365   0.775066   
50%     1.692550   2.328214   0.650700   0.788912   0.935093   0.874408   
75%     1.724165   2.352930   0.663386   0.795110   1.060103   1.132949   
max     1.757505   2.475099   0.676041   0.798610   2.462503   6.063923   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.424512  152.988067   0.004325   0.007633  
std     0.029141    7.248857   0.006910   0.012443  
min     0.362205  141.274022  -0.006812  -0.012853  
25%     0.407466  148.161140  -0.001129  -0.002094  
50%     0.424653  151.755239   0.003296   0.005683  
75%     0.443348  157.515627   0.009594   0.017346  
max     0.475289  168.416540   0.016393   0.029619  
--------------------------------------------------------------------------------
Test metrics on ultisols
--------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.201589   1.665164   0.296985   0.581148   0.326529   0.109017   
std     0.067696   0.152486   0.081464   0.056106   0.050224   0.034916   
min     1.079312   1.352102   0.136519   0.489327   0.252949   0.063983   
25%     1.151943   1.560671   0.242226   0.546748   0.295477   0.087307   
50%     1.207474   1.676421   0.310236   0.584230   0.321999   0.103689   
75%     1.237247   1.789812   0.343037   0.616695   0.350845   0.123099   
max     1.329557   1.890884   0.430578   0.701262   0.450793   0.203214   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.181925   80.909836   0.039877   0.094603  
std     0.025022    9.029538   0.014663   0.031388  
min     0.150119   67.915820   0.013417   0.031652  
25%     0.164187   74.465798   0.025832   0.068632  
50%     0.174361   80.450314   0.037480   0.100163  
75%     0.197729   88.393075   0.050413   0.112495  
max     0.249080  101.466523   0.065988   0.147605  
--------------------------------------------------------------------------------
Test metrics on andisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.561501   2.013977   0.584894   0.728846   0.592610   0.428996   
std     0.054676   0.214017   0.028844   0.027988   0.286190   0.451123   
min     1.462280   1.607348   0.528559   0.677337   0.344830   0.118907   
25%     1.522535   1.939558   0.564517   0.712462   0.397968   0.158418   
50%     1.560284   2.031585   0.585664   0.727166   0.479231   0.229689   
75%     1.594774   2.100454   0.603265   0.746108   0.630045   0.397882   
max     1.659770   2.348595   0.633790   0.781835   1.299265   1.688089   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.281092  106.394236   0.015788   0.033443  
std     0.049266   11.345530   0.017747   0.037467  
min     0.205634   84.861332  -0.015052  -0.033935  
25%     0.241596   98.732944   0.005526   0.013816  
50%     0.288964  106.024153   0.013751   0.028963  
75%     0.307314  112.704328   0.029538   0.064234  
max     0.390000  130.842886   0.043541   0.094777  
--------------------------------------------------------------------------------
Test metrics on histosols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.711375   2.500980   0.637454   0.778795   1.165003   1.492735   
std     0.214934   0.635935   0.090172   0.055099   0.377669   1.060323   
min     1.374536   1.609684   0.462316   0.677843   0.634321   0.402363   
25%     1.566681   2.034666   0.586609   0.753988   0.927356   0.860062   
50%     1.681201   2.410043   0.641241   0.776610   1.093495   1.195750   
75%     1.820641   2.907901   0.693132   0.811247   1.278496   1.634970   
max     2.161752   3.628460   0.782561   0.867816   2.175235   4.731648   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.610852  243.155805   0.001554  -0.003005  
std     0.133948   46.102071   0.035374   0.045302  
min     0.380170  172.238410  -0.064465  -0.110639  
25%     0.546008  210.254481  -0.010255  -0.015323  
50%     0.567238  231.883135  -0.000548  -0.000847  
75%     0.674668  284.666143   0.009428   0.010923  
max     0.865779  324.890279   0.077207   0.078856  
--------------------------------------------------------------------------------
Test metrics on vertisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.524148   2.101732   0.547234   0.732481   0.390509   0.161691   
std     0.175537   0.331334   0.101618   0.061666   0.098375   0.090253   
min     1.233878   1.556100   0.333783   0.607804   0.279383   0.078055   
25%     1.428539   1.912700   0.503573   0.695811   0.327822   0.107521   
50%     1.478822   2.143325   0.536402   0.728507   0.361795   0.130898   
75%     1.632835   2.287894   0.619066   0.781692   0.423892   0.179688   
max     1.895009   2.787665   0.717768   0.831755   0.673910   0.454155   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.238076   98.744299  -0.052767  -0.134787  
std     0.035953   12.347859   0.015789   0.043975  
min     0.183381   83.009898  -0.075401  -0.206095  
25%     0.206193   89.681748  -0.061264  -0.162066  
50%     0.231768   94.428492  -0.055714  -0.138102  
75%     0.259825  106.099271  -0.046249  -0.110102  
max     0.309477  127.327009  -0.015200  -0.042732  
--------------------------------------------------------------------------------
Test metrics on aridisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse         mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000   20.000000   
mean    1.378008   1.827588   0.444671   0.686068   2.131294   11.685892   
std     0.164302   0.273668   0.154683   0.067033   2.742162   28.829063   
min     1.015784   1.353244   0.024153   0.533021   0.484385    0.234629   
25%     1.294828   1.616959   0.398816   0.656175   0.657982    0.433422   
50%     1.420750   1.811119   0.501060   0.704963   1.069559    1.148925   
75%     1.471227   2.008619   0.534730   0.727574   1.995471    4.232994   
max     1.643348   2.293749   0.626948   0.771557  10.787938  116.379602   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.500131  145.908265  -0.010957  -0.025541  
std     0.250221   56.170231   0.018981   0.046494  
min     0.294676   96.568375  -0.047555  -0.126001  
25%     0.352105  113.472506  -0.021256  -0.045881  
50%     0.403889  124.989228  -0.007535  -0.013668  
75%     0.562606  154.904255   0.004738   0.008801  
max     1.257594  322.681936   0.015741   0.036257  
--------------------------------------------------------------------------------
Test metrics on gelisols
--------------------------------------------------------------------------------
             rpd       rpiq         r2       lccc       rmse        mse  \
count  20.000000  20.000000  20.000000  20.000000  20.000000  20.000000   
mean    1.692878   2.534223   0.626330   0.766703   0.646289   0.435929   
std     0.200619   0.761655   0.096257   0.059995   0.138561   0.188936   
min     1.274587   1.094882   0.368254   0.619306   0.418552   0.175186   
25%     1.607986   2.005345   0.602193   0.747244   0.552801   0.305750   
50%     1.651799   2.517481   0.624528   0.765263   0.631649   0.398982   
75%     1.849051   2.810388   0.698211   0.819691   0.723203   0.523037   
max     2.033034   3.926091   0.752298   0.864522   0.954032   0.910176   

             mae        mape       bias        stb  
count  20.000000   20.000000  20.000000  20.000000  
mean    0.389866  193.838336  -0.088982  -0.145424  
std     0.084392   31.399886   0.034638   0.082395  
min     0.255306  134.782910  -0.161743  -0.406283  
25%     0.324760  169.096695  -0.107498  -0.178604  
50%     0.390097  191.552850  -0.092811  -0.129146  
75%     0.459532  213.219983  -0.058120  -0.106705  
max     0.542090  257.645578  -0.023931  -0.030365  </code></pre>
</div>
</div>
</section>
<section id="evaluate-on-mollisols" class="level4">
<h4 class="anchored" data-anchor-id="evaluate-on-mollisols">Evaluate on Mollisols</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/all/models'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>perfs_global_mollisols, _, _ <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                                 order<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                                 src_dir_model<span class="op">=</span>src_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>perfs_global_mollisols.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rpd</th>
      <th>rpiq</th>
      <th>r2</th>
      <th>lccc</th>
      <th>rmse</th>
      <th>mse</th>
      <th>mae</th>
      <th>mape</th>
      <th>bias</th>
      <th>stb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.582966</td>
      <td>2.090417</td>
      <td>0.599952</td>
      <td>0.742203</td>
      <td>0.769248</td>
      <td>0.629664</td>
      <td>0.307466</td>
      <td>94.298259</td>
      <td>0.001662</td>
      <td>0.003734</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.034982</td>
      <td>0.078073</td>
      <td>0.017652</td>
      <td>0.012356</td>
      <td>0.199794</td>
      <td>0.322337</td>
      <td>0.018656</td>
      <td>3.052491</td>
      <td>0.008008</td>
      <td>0.018876</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.525933</td>
      <td>1.972214</td>
      <td>0.570089</td>
      <td>0.722419</td>
      <td>0.526864</td>
      <td>0.277585</td>
      <td>0.279430</td>
      <td>87.394573</td>
      <td>-0.013899</td>
      <td>-0.033922</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.558545</td>
      <td>2.042070</td>
      <td>0.587883</td>
      <td>0.734876</td>
      <td>0.600345</td>
      <td>0.360454</td>
      <td>0.289349</td>
      <td>92.537801</td>
      <td>-0.004175</td>
      <td>-0.009866</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.579016</td>
      <td>2.077462</td>
      <td>0.598502</td>
      <td>0.738004</td>
      <td>0.735055</td>
      <td>0.541195</td>
      <td>0.308846</td>
      <td>94.409650</td>
      <td>0.001370</td>
      <td>0.003153</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.610838</td>
      <td>2.141203</td>
      <td>0.614204</td>
      <td>0.752421</td>
      <td>0.917944</td>
      <td>0.842758</td>
      <td>0.320209</td>
      <td>96.313669</td>
      <td>0.008152</td>
      <td>0.018857</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.642984</td>
      <td>2.250635</td>
      <td>0.629145</td>
      <td>0.764131</td>
      <td>1.123730</td>
      <td>1.262768</td>
      <td>0.340558</td>
      <td>98.688058</td>
      <td>0.014374</td>
      <td>0.032833</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="evaluate-on-gelisols" class="level4">
<h4 class="anchored" data-anchor-id="evaluate-on-gelisols">Evaluate on Gelisols</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/all/models'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>perfs_global_gelisols, _, _ <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                                                order<span class="op">=</span>order,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                                                src_dir_model<span class="op">=</span>src_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>perfs_global_gelisols.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rpd</th>
      <th>rpiq</th>
      <th>r2</th>
      <th>lccc</th>
      <th>rmse</th>
      <th>mse</th>
      <th>mae</th>
      <th>mape</th>
      <th>bias</th>
      <th>stb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.692878</td>
      <td>2.534223</td>
      <td>0.626330</td>
      <td>0.766703</td>
      <td>0.646289</td>
      <td>0.435929</td>
      <td>0.389866</td>
      <td>193.838336</td>
      <td>-0.088982</td>
      <td>-0.145424</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.200619</td>
      <td>0.761655</td>
      <td>0.096257</td>
      <td>0.059995</td>
      <td>0.138561</td>
      <td>0.188936</td>
      <td>0.084392</td>
      <td>31.399886</td>
      <td>0.034638</td>
      <td>0.082395</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.274587</td>
      <td>1.094882</td>
      <td>0.368254</td>
      <td>0.619306</td>
      <td>0.418552</td>
      <td>0.175186</td>
      <td>0.255306</td>
      <td>134.782910</td>
      <td>-0.161743</td>
      <td>-0.406283</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.607986</td>
      <td>2.005345</td>
      <td>0.602193</td>
      <td>0.747244</td>
      <td>0.552801</td>
      <td>0.305750</td>
      <td>0.324760</td>
      <td>169.096695</td>
      <td>-0.107498</td>
      <td>-0.178604</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.651799</td>
      <td>2.517481</td>
      <td>0.624528</td>
      <td>0.765263</td>
      <td>0.631649</td>
      <td>0.398982</td>
      <td>0.390097</td>
      <td>191.552850</td>
      <td>-0.092811</td>
      <td>-0.129146</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.849051</td>
      <td>2.810388</td>
      <td>0.698211</td>
      <td>0.819691</td>
      <td>0.723203</td>
      <td>0.523037</td>
      <td>0.459532</td>
      <td>213.219983</td>
      <td>-0.058120</td>
      <td>-0.106705</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.033034</td>
      <td>3.926091</td>
      <td>0.752298</td>
      <td>0.864522</td>
      <td>0.954032</td>
      <td>0.910176</td>
      <td>0.542090</td>
      <td>257.645578</td>
      <td>-0.023931</td>
      <td>-0.030365</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="evaluate-on-vertisols" class="level4">
<h4 class="anchored" data-anchor-id="evaluate-on-vertisols">Evaluate on Vertisols</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/all/models'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>perfs_global_vertisols, _, _ <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                                 order<span class="op">=</span>order,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                                                 src_dir_model<span class="op">=</span>src_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>perfs_global_vertisols.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rpd</th>
      <th>rpiq</th>
      <th>r2</th>
      <th>lccc</th>
      <th>rmse</th>
      <th>mse</th>
      <th>mae</th>
      <th>mape</th>
      <th>bias</th>
      <th>stb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.524148</td>
      <td>2.101732</td>
      <td>0.547234</td>
      <td>0.732481</td>
      <td>0.390509</td>
      <td>0.161691</td>
      <td>0.238076</td>
      <td>98.744299</td>
      <td>-0.052767</td>
      <td>-0.134787</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.175537</td>
      <td>0.331334</td>
      <td>0.101618</td>
      <td>0.061666</td>
      <td>0.098375</td>
      <td>0.090253</td>
      <td>0.035953</td>
      <td>12.347859</td>
      <td>0.015789</td>
      <td>0.043975</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.233878</td>
      <td>1.556100</td>
      <td>0.333783</td>
      <td>0.607804</td>
      <td>0.279383</td>
      <td>0.078055</td>
      <td>0.183381</td>
      <td>83.009898</td>
      <td>-0.075401</td>
      <td>-0.206095</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.428539</td>
      <td>1.912700</td>
      <td>0.503573</td>
      <td>0.695811</td>
      <td>0.327822</td>
      <td>0.107521</td>
      <td>0.206193</td>
      <td>89.681748</td>
      <td>-0.061264</td>
      <td>-0.162066</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.478822</td>
      <td>2.143325</td>
      <td>0.536402</td>
      <td>0.728507</td>
      <td>0.361795</td>
      <td>0.130898</td>
      <td>0.231768</td>
      <td>94.428492</td>
      <td>-0.055714</td>
      <td>-0.138102</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.632835</td>
      <td>2.287894</td>
      <td>0.619066</td>
      <td>0.781692</td>
      <td>0.423892</td>
      <td>0.179688</td>
      <td>0.259825</td>
      <td>106.099271</td>
      <td>-0.046249</td>
      <td>-0.110102</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.895009</td>
      <td>2.787665</td>
      <td>0.717768</td>
      <td>0.831755</td>
      <td>0.673910</td>
      <td>0.454155</td>
      <td>0.309477</td>
      <td>127.327009</td>
      <td>-0.015200</td>
      <td>-0.042732</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="train-and-test-on-mollisols" class="level3">
<h3 class="anchored" data-anchor-id="train-and-test-on-mollisols">Train and test on Mollisols</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dest_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/mollisols/models'</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>learners.train((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]), </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>               order<span class="op">=</span>order,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>               n_cpts_range<span class="op">=</span><span class="bu">range</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">2</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>               delta<span class="op">=</span><span class="fl">2e-3</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>               dest_dir_model<span class="op">=</span>dest_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------------------------------------
Seed: 0
--------------------------------------------------------------------------------
# of components chosen: 46
--------------------------------------------------------------------------------
Seed: 1
--------------------------------------------------------------------------------
# of components chosen: 52
--------------------------------------------------------------------------------
Seed: 2
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 3
--------------------------------------------------------------------------------
# of components chosen: 40
--------------------------------------------------------------------------------
Seed: 4
--------------------------------------------------------------------------------
# of components chosen: 46
--------------------------------------------------------------------------------
Seed: 5
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 6
--------------------------------------------------------------------------------
# of components chosen: 40
--------------------------------------------------------------------------------
Seed: 7
--------------------------------------------------------------------------------
# of components chosen: 40
--------------------------------------------------------------------------------
Seed: 8
--------------------------------------------------------------------------------
# of components chosen: 40
--------------------------------------------------------------------------------
Seed: 9
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 10
--------------------------------------------------------------------------------
# of components chosen: 54
--------------------------------------------------------------------------------
Seed: 11
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 12
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 13
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 14
--------------------------------------------------------------------------------
# of components chosen: 56
--------------------------------------------------------------------------------
Seed: 15
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 16
--------------------------------------------------------------------------------
# of components chosen: 34
--------------------------------------------------------------------------------
Seed: 17
--------------------------------------------------------------------------------
# of components chosen: 40
--------------------------------------------------------------------------------
Seed: 18
--------------------------------------------------------------------------------
# of components chosen: 50
--------------------------------------------------------------------------------
Seed: 19
--------------------------------------------------------------------------------
# of components chosen: 34</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/mollisols/models'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>perfs_local_mollisols, _, _ <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                                order<span class="op">=</span>order,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                                                src_dir_model<span class="op">=</span>src_dir_model)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>perfs_local_mollisols.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rpd</th>
      <th>rpiq</th>
      <th>r2</th>
      <th>lccc</th>
      <th>rmse</th>
      <th>mse</th>
      <th>mae</th>
      <th>mape</th>
      <th>bias</th>
      <th>stb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.729961</td>
      <td>2.284160</td>
      <td>0.664719</td>
      <td>0.803311</td>
      <td>0.682758</td>
      <td>0.501425</td>
      <td>0.271352</td>
      <td>102.920252</td>
      <td>0.000623</td>
      <td>0.001149</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.049480</td>
      <td>0.085176</td>
      <td>0.019570</td>
      <td>0.011727</td>
      <td>0.192671</td>
      <td>0.281706</td>
      <td>0.014817</td>
      <td>3.289161</td>
      <td>0.008043</td>
      <td>0.018940</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.620689</td>
      <td>2.157094</td>
      <td>0.618909</td>
      <td>0.776560</td>
      <td>0.431012</td>
      <td>0.185771</td>
      <td>0.243688</td>
      <td>95.089908</td>
      <td>-0.016145</td>
      <td>-0.039405</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.704100</td>
      <td>2.221866</td>
      <td>0.655256</td>
      <td>0.801153</td>
      <td>0.535298</td>
      <td>0.286687</td>
      <td>0.261261</td>
      <td>100.989098</td>
      <td>-0.005376</td>
      <td>-0.012943</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.734100</td>
      <td>2.282031</td>
      <td>0.667110</td>
      <td>0.803882</td>
      <td>0.609356</td>
      <td>0.371682</td>
      <td>0.273628</td>
      <td>103.076593</td>
      <td>-0.001222</td>
      <td>-0.002843</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.759684</td>
      <td>2.322080</td>
      <td>0.676704</td>
      <td>0.809385</td>
      <td>0.793591</td>
      <td>0.630660</td>
      <td>0.275906</td>
      <td>105.139386</td>
      <td>0.007436</td>
      <td>0.017265</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.827361</td>
      <td>2.468705</td>
      <td>0.700207</td>
      <td>0.826625</td>
      <td>1.028421</td>
      <td>1.057650</td>
      <td>0.303412</td>
      <td>108.383273</td>
      <td>0.013749</td>
      <td>0.033221</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="train-and-test-on-gelisols" class="level3">
<h3 class="anchored" data-anchor-id="train-and-test-on-gelisols">Train and test on Gelisols</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dest_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/gelisols/models'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>learners.train((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]), </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>               order<span class="op">=</span>order,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>               n_cpts_range<span class="op">=</span><span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">1</span>),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>               delta<span class="op">=</span><span class="fl">1e-2</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>               dest_dir_model<span class="op">=</span>dest_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------------------------------------
Seed: 0
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 1
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 2
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 3
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 4
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 5
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 6
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 7
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 8
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 9
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 10
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 11
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 12
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 13
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 14
--------------------------------------------------------------------------------
# of components chosen: 8
--------------------------------------------------------------------------------
Seed: 15
--------------------------------------------------------------------------------
# of components chosen: 7
--------------------------------------------------------------------------------
Seed: 16
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 17
--------------------------------------------------------------------------------
# of components chosen: 7
--------------------------------------------------------------------------------
Seed: 18
--------------------------------------------------------------------------------
# of components chosen: 7
--------------------------------------------------------------------------------
Seed: 19
--------------------------------------------------------------------------------
# of components chosen: 9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/gelisols/models'</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>perfs_local_gelisols, _, _ <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                                                order<span class="op">=</span>order,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                                src_dir_model<span class="op">=</span>src_dir_model)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>perfs_local_gelisols.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rpd</th>
      <th>rpiq</th>
      <th>r2</th>
      <th>lccc</th>
      <th>rmse</th>
      <th>mse</th>
      <th>mae</th>
      <th>mape</th>
      <th>bias</th>
      <th>stb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.077886</td>
      <td>3.084523</td>
      <td>0.746774</td>
      <td>0.858587</td>
      <td>0.646908</td>
      <td>0.452289</td>
      <td>0.319878</td>
      <td>205.707385</td>
      <td>-0.002118</td>
      <td>-0.006263</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.308216</td>
      <td>0.896429</td>
      <td>0.076636</td>
      <td>0.042218</td>
      <td>0.188620</td>
      <td>0.248623</td>
      <td>0.069856</td>
      <td>44.668977</td>
      <td>0.040502</td>
      <td>0.064437</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.547630</td>
      <td>1.263899</td>
      <td>0.570562</td>
      <td>0.773000</td>
      <td>0.348828</td>
      <td>0.121681</td>
      <td>0.208846</td>
      <td>122.575289</td>
      <td>-0.067213</td>
      <td>-0.125266</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.823879</td>
      <td>2.564071</td>
      <td>0.692319</td>
      <td>0.827514</td>
      <td>0.530327</td>
      <td>0.281372</td>
      <td>0.269832</td>
      <td>172.185662</td>
      <td>-0.025272</td>
      <td>-0.038202</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.053352</td>
      <td>3.090948</td>
      <td>0.756956</td>
      <td>0.857239</td>
      <td>0.614913</td>
      <td>0.378319</td>
      <td>0.308076</td>
      <td>204.408200</td>
      <td>-0.007451</td>
      <td>-0.014036</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.299863</td>
      <td>3.404348</td>
      <td>0.805802</td>
      <td>0.899488</td>
      <td>0.817420</td>
      <td>0.669407</td>
      <td>0.361622</td>
      <td>227.222367</td>
      <td>0.016758</td>
      <td>0.020807</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.652731</td>
      <td>5.047128</td>
      <td>0.851434</td>
      <td>0.914563</td>
      <td>0.913832</td>
      <td>0.835089</td>
      <td>0.452944</td>
      <td>302.505106</td>
      <td>0.103336</td>
      <td>0.170306</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="train-and-test-on-vertisols" class="level3">
<h3 class="anchored" data-anchor-id="train-and-test-on-vertisols">Train and test on Vertisols</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dest_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/vertisols/models'</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>learners.train((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]), </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>               order<span class="op">=</span>order,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>               n_cpts_range<span class="op">=</span><span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">30</span>, <span class="dv">1</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>               delta<span class="op">=</span><span class="fl">1e-2</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>               dest_dir_model<span class="op">=</span>dest_dir_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------------------------------------------
Seed: 0
--------------------------------------------------------------------------------
# of components chosen: 11
--------------------------------------------------------------------------------
Seed: 1
--------------------------------------------------------------------------------
# of components chosen: 11
--------------------------------------------------------------------------------
Seed: 2
--------------------------------------------------------------------------------
# of components chosen: 20
--------------------------------------------------------------------------------
Seed: 3
--------------------------------------------------------------------------------
# of components chosen: 18
--------------------------------------------------------------------------------
Seed: 4
--------------------------------------------------------------------------------
# of components chosen: 12
--------------------------------------------------------------------------------
Seed: 5
--------------------------------------------------------------------------------
# of components chosen: 10
--------------------------------------------------------------------------------
Seed: 6
--------------------------------------------------------------------------------
# of components chosen: 17
--------------------------------------------------------------------------------
Seed: 7
--------------------------------------------------------------------------------
# of components chosen: 8
--------------------------------------------------------------------------------
Seed: 8
--------------------------------------------------------------------------------
# of components chosen: 15
--------------------------------------------------------------------------------
Seed: 9
--------------------------------------------------------------------------------
# of components chosen: 11
--------------------------------------------------------------------------------
Seed: 10
--------------------------------------------------------------------------------
# of components chosen: 9
--------------------------------------------------------------------------------
Seed: 11
--------------------------------------------------------------------------------
# of components chosen: 12
--------------------------------------------------------------------------------
Seed: 12
--------------------------------------------------------------------------------
# of components chosen: 19
--------------------------------------------------------------------------------
Seed: 13
--------------------------------------------------------------------------------
# of components chosen: 11
--------------------------------------------------------------------------------
Seed: 14
--------------------------------------------------------------------------------
# of components chosen: 12
--------------------------------------------------------------------------------
Seed: 15
--------------------------------------------------------------------------------
# of components chosen: 15
--------------------------------------------------------------------------------
Seed: 16
--------------------------------------------------------------------------------
# of components chosen: 14
--------------------------------------------------------------------------------
Seed: 17
--------------------------------------------------------------------------------
# of components chosen: 12
--------------------------------------------------------------------------------
Seed: 18
--------------------------------------------------------------------------------
# of components chosen: 8
--------------------------------------------------------------------------------
Seed: 19
--------------------------------------------------------------------------------
# of components chosen: 11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>src_dir_model <span class="op">=</span> Path(<span class="st">'files/dumps/plsr/train_eval/vertisols/models'</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>seeds <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>learners <span class="op">=</span> Learners(tax_lookup, seeds<span class="op">=</span>seeds)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>perfs_local_vertisols, _, _ <span class="op">=</span> learners.evaluate((X, y, depth_order[:, <span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                                                order<span class="op">=</span>order,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                                                src_dir_model<span class="op">=</span>src_dir_model)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>perfs_local_vertisols.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rpd</th>
      <th>rpiq</th>
      <th>r2</th>
      <th>lccc</th>
      <th>rmse</th>
      <th>mse</th>
      <th>mae</th>
      <th>mape</th>
      <th>bias</th>
      <th>stb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.009008</td>
      <td>2.772106</td>
      <td>0.737918</td>
      <td>0.855452</td>
      <td>0.285306</td>
      <td>0.084297</td>
      <td>0.187213</td>
      <td>93.891373</td>
      <td>-0.004065</td>
      <td>-0.011017</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.233000</td>
      <td>0.461799</td>
      <td>0.071342</td>
      <td>0.035866</td>
      <td>0.055230</td>
      <td>0.033674</td>
      <td>0.024124</td>
      <td>11.393788</td>
      <td>0.020619</td>
      <td>0.053431</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.410521</td>
      <td>1.902507</td>
      <td>0.490198</td>
      <td>0.741338</td>
      <td>0.182039</td>
      <td>0.033138</td>
      <td>0.129494</td>
      <td>76.538749</td>
      <td>-0.041485</td>
      <td>-0.121708</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.894380</td>
      <td>2.447912</td>
      <td>0.717390</td>
      <td>0.849941</td>
      <td>0.247126</td>
      <td>0.061071</td>
      <td>0.173790</td>
      <td>85.490789</td>
      <td>-0.016195</td>
      <td>-0.042687</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.024185</td>
      <td>2.805916</td>
      <td>0.752705</td>
      <td>0.860249</td>
      <td>0.283139</td>
      <td>0.080169</td>
      <td>0.188396</td>
      <td>91.373366</td>
      <td>-0.002301</td>
      <td>-0.006435</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.081399</td>
      <td>3.036756</td>
      <td>0.766082</td>
      <td>0.870251</td>
      <td>0.299627</td>
      <td>0.089804</td>
      <td>0.204240</td>
      <td>102.965234</td>
      <td>0.007755</td>
      <td>0.018465</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.549723</td>
      <td>3.779666</td>
      <td>0.843884</td>
      <td>0.916982</td>
      <td>0.418275</td>
      <td>0.174954</td>
      <td>0.223513</td>
      <td>113.539148</td>
      <td>0.036139</td>
      <td>0.086563</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="compile-metrics-for-local-vs.-global-fig.-6" class="level3">
<h3 class="anchored" data-anchor-id="compile-metrics-for-local-vs.-global-fig.-6">Compile metrics for “local vs.&nbsp;global” Fig. 6</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_metrics(<span class="op">*</span>dfs):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    perfs <span class="op">=</span> {<span class="st">'r2'</span>: {<span class="st">'mean'</span>: [], <span class="st">'std'</span>: []},</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">'mape'</span>: {<span class="st">'mean'</span>: [], <span class="st">'std'</span>: []}}</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> df <span class="kw">in</span> dfs:</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metric <span class="kw">in</span> [<span class="st">'r2'</span>, <span class="st">'mape'</span>]:</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>            mean, std <span class="op">=</span> df.describe().loc[[<span class="st">'mean'</span>, <span class="st">'std'</span>], metric].items()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>            perfs[metric][<span class="st">'mean'</span>].append(mean[<span class="dv">1</span>])</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            perfs[metric][<span class="st">'std'</span>].append(std[<span class="dv">1</span>])</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> perfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>perfs <span class="op">=</span> {}</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>perfs[<span class="st">'global'</span>] <span class="op">=</span> format_metrics(perfs_global_mollisols, perfs_global_gelisols, perfs_global_vertisols)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>perfs[<span class="st">'local'</span>] <span class="op">=</span> format_metrics(perfs_local_mollisols, perfs_local_gelisols, perfs_local_vertisols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>perfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'global': {'r2': {'mean': [0.5999520975577833,
    0.6263296407122689,
    0.5472338139745212],
   'std': [0.01765197454826005, 0.09625659382541236, 0.10161782452206956]},
  'mape': {'mean': [94.29825920533892, 193.83833562261376, 98.74429900717739],
   'std': [3.0524914231457974, 31.399886042493737, 12.347859402802634]}},
 'local': {'r2': {'mean': [0.6647188332987304,
    0.7467735410966299,
    0.737918199125363],
   'std': [0.01957008650036342, 0.07663555355310155, 0.07134199041747523]},
  'mape': {'mean': [102.92025183047231, 205.70738511998024, 93.89137312512031],
   'std': [3.289160840803382, 44.668977271871476, 11.393787965933955]}}}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>dest_dir <span class="op">=</span> Path(<span class="st">'files/dumps/plsr'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(dest_dir<span class="op">/</span><span class="st">'global_vs_local.pickle'</span>, <span class="st">'wb'</span>) <span class="im">as</span> f: </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                pickle.dump(perfs, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>